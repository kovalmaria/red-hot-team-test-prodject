<style>
  /* Контейнер акордеону */
.product-accordion {
  border-top: 1px solid rgba(var(--color-foreground), 0.08);
  border-bottom: 1px solid rgba(var(--color-foreground), 0.08);
  margin-top: 2rem;
  margin-bottom: 2rem;
}

/* Елемент акордеону */
.accordion-item {
  border-top: 1px solid rgba(var(--color-foreground), 0.08);
}

/* Заголовок */
.accordion-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  padding: 1.2rem 0;
  user-select: none;
  font-weight: 600;
}

.accordion__title {
  margin: 0;
  font-size: 1.6rem;
  flex: 1;
}

/* Іконка (стрілочка) */
.accordion-header svg {
  transition: transform 0.3s ease;
  width: 1rem;
  height: 1rem;
}

/* Обертаємо стрілку при відкритому акордеоні */
.accordion-item[open] .accordion-header svg {
  transform: rotate(180deg);
}

/* Контент */
.accordion__content {
  padding: 0.8rem 0;
  font-size: 1.4rem;
  color: rgba(var(--color-foreground), 0.8);
  animation: fadeIn 0.3s ease;
}

.accordion__content img {
  max-width: 100%;
  height: auto;
}

/* Анімація */
@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

</style>

{% assign titles = product.metafields.custom.accordion_titles.value %}
{% assign contents = product.metafields.custom.accordion_contents.value %}
{% assign allow_multiple = product.metafields.custom.accordion_multiple_open.value | default: false %}

{% if titles and contents and titles.size > 0 and titles.size == contents.size %}
  <div class="product__accordion accordion quick-add-hidden">
    <div class="product-accordion" data-allow-multiple="{{ allow_multiple }}">
      {% for title in titles %}
        {% assign index = forloop.index0 %}
        {% assign content = contents[index] %}
        {% if content != blank %}
          <details class="accordion-item">
            <summary class="accordion-header">
              <h2 class="h4 accordion__title inline-richtext">{{ title }}</h2>
              {{ 'icon-caret.svg' | inline_asset_content }}
            </summary>
            <div class="accordion__content rte">
              {{ content }}
            </div>
          </details>
        {% endif %}
      {% endfor %}
    </div>
  </div>
{% elsif request.design_mode %}
  <!-- показати заглушку в редакторі -->
  <div class="product__accordion accordion quick-add-hidden">
    <div class="product-accordion">
      <details class="accordion-item" open>
        <summary class="accordion-header">
          <h2 class="h4 accordion__title inline-richtext">Accordion Title</h2>
          {{ 'icon-caret.svg' | inline_asset_content }}
        </summary>
        <div class="accordion__content rte">
          This is a sample accordion content. Add metafields to see real data.
        </div>
      </details>
    </div>
  </div>
{% endif %}



<script>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.product-accordion').forEach(container => {
      const allowMultiple = container.dataset.allowMultiple === 'true';
      console.log('loading')
  
      container.querySelectorAll('details').forEach(details => {
        details.addEventListener('toggle', () => {
          if (!allowMultiple && details.open) {
            container.querySelectorAll('details').forEach(other => {
              if (other !== details) {
                other.removeAttribute('open');
              }
            });
          }
        });
      });
    });
  });
  
</script>
